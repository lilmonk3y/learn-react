{"ast":null,"code":"import React from \"react\";\nconst localStorageKey = 'MY_TODOS_V1';\nconst initialValue = [{\n  text: \"comprar lechuga\",\n  completed: false\n}, {\n  text: \"comprar papa\",\n  completed: true\n}, {\n  text: \"comprar tomate\",\n  completed: false\n}];\n\nfunction useLocalStorage() {\n  const [error, setError] = React.useState(false);\n  const [loading, setLoading] = React.useState(true);\n  const [item, setItem] = React.useState(initialValue);\n  React.useEffect(() => {\n    setTimeout(() => {\n      try {\n        const localStorageItem = localStorage.getItem(localStorageKey);\n        let parsedItem;\n\n        if (!localStorageItem) {\n          localStorage.setItem(localStorageKey, JSON.stringify(initialValue));\n          parsedItem = initialValue;\n        } else {\n          parsedItem = JSON.parse(localStorageItem);\n        }\n\n        setItem(parsedItem);\n        setLoading(false);\n      } catch (error) {\n        console.log('failed to load data with error: ' + error);\n        setError(true);\n      }\n    }, 1000);\n  });\n\n  const saveItem = items => {\n    localStorage.setItem(localStorageKey, JSON.stringify(items));\n    setItem(items);\n  };\n\n  return {\n    error,\n    loading,\n    item,\n    saveItem\n  };\n}\n\nexport { useLocalStorage, localStorageKey };","map":{"version":3,"names":["React","localStorageKey","initialValue","text","completed","useLocalStorage","error","setError","useState","loading","setLoading","item","setItem","useEffect","setTimeout","localStorageItem","localStorage","getItem","parsedItem","JSON","stringify","parse","console","log","saveItem","items"],"sources":["/home/christian/Code/todo-made-in-react/src/Storage/useLocalStorage.tsx"],"sourcesContent":["import React from \"react\";\nimport {Todo} from \"../Todo/Todo\";\n\nconst localStorageKey = 'MY_TODOS_V1';\n\nconst initialValue : Todo[] = [\n  {text:\"comprar lechuga\", completed: false},\n  {text:\"comprar papa\", completed: true},\n  {text:\"comprar tomate\", completed: false}];\n\nfunction useLocalStorage() {\n  const [error, setError] = React.useState(false);\n  const [loading, setLoading] = React.useState(true);\n  const [item, setItem] = React.useState(initialValue);\n\n  React.useEffect(() => {\n    setTimeout(() => {\n      try {\n        const localStorageItem = localStorage.getItem(localStorageKey);\n        let parsedItem :Todo[];\n\n        if (!localStorageItem) {\n          localStorage.setItem(localStorageKey, JSON.stringify(initialValue));\n          parsedItem = initialValue;\n        } else {\n          parsedItem = JSON.parse(localStorageItem as string) as Array<Todo>;\n        }\n\n        setItem(parsedItem);\n        setLoading(false);\n      } catch(error) {\n        console.log('failed to load data with error: ' + error);\n        setError(true);\n      }\n    }, 1000);\n  });\n\n  const saveItem = (items : Todo[]) => {\n    localStorage.setItem(localStorageKey, JSON.stringify(items));\n    setItem(items);\n  }\n\n  return {\n    error,\n    loading,\n    item,\n    saveItem,\n  };\n}\n\nexport {useLocalStorage, localStorageKey}"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAGA,MAAMC,eAAe,GAAG,aAAxB;AAEA,MAAMC,YAAqB,GAAG,CAC5B;EAACC,IAAI,EAAC,iBAAN;EAAyBC,SAAS,EAAE;AAApC,CAD4B,EAE5B;EAACD,IAAI,EAAC,cAAN;EAAsBC,SAAS,EAAE;AAAjC,CAF4B,EAG5B;EAACD,IAAI,EAAC,gBAAN;EAAwBC,SAAS,EAAE;AAAnC,CAH4B,CAA9B;;AAKA,SAASC,eAAT,GAA2B;EACzB,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBP,KAAK,CAACQ,QAAN,CAAe,KAAf,CAA1B;EACA,MAAM,CAACC,OAAD,EAAUC,UAAV,IAAwBV,KAAK,CAACQ,QAAN,CAAe,IAAf,CAA9B;EACA,MAAM,CAACG,IAAD,EAAOC,OAAP,IAAkBZ,KAAK,CAACQ,QAAN,CAAeN,YAAf,CAAxB;EAEAF,KAAK,CAACa,SAAN,CAAgB,MAAM;IACpBC,UAAU,CAAC,MAAM;MACf,IAAI;QACF,MAAMC,gBAAgB,GAAGC,YAAY,CAACC,OAAb,CAAqBhB,eAArB,CAAzB;QACA,IAAIiB,UAAJ;;QAEA,IAAI,CAACH,gBAAL,EAAuB;UACrBC,YAAY,CAACJ,OAAb,CAAqBX,eAArB,EAAsCkB,IAAI,CAACC,SAAL,CAAelB,YAAf,CAAtC;UACAgB,UAAU,GAAGhB,YAAb;QACD,CAHD,MAGO;UACLgB,UAAU,GAAGC,IAAI,CAACE,KAAL,CAAWN,gBAAX,CAAb;QACD;;QAEDH,OAAO,CAACM,UAAD,CAAP;QACAR,UAAU,CAAC,KAAD,CAAV;MACD,CAbD,CAaE,OAAMJ,KAAN,EAAa;QACbgB,OAAO,CAACC,GAAR,CAAY,qCAAqCjB,KAAjD;QACAC,QAAQ,CAAC,IAAD,CAAR;MACD;IACF,CAlBS,EAkBP,IAlBO,CAAV;EAmBD,CApBD;;EAsBA,MAAMiB,QAAQ,GAAIC,KAAD,IAAoB;IACnCT,YAAY,CAACJ,OAAb,CAAqBX,eAArB,EAAsCkB,IAAI,CAACC,SAAL,CAAeK,KAAf,CAAtC;IACAb,OAAO,CAACa,KAAD,CAAP;EACD,CAHD;;EAKA,OAAO;IACLnB,KADK;IAELG,OAFK;IAGLE,IAHK;IAILa;EAJK,CAAP;AAMD;;AAED,SAAQnB,eAAR,EAAyBJ,eAAzB"},"metadata":{},"sourceType":"module"}