{"ast":null,"code":"import _slicedToArray from\"/home/christian/Code/todo-made-in-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React from\"react\";var localStorageKey='MY_TODOS_V1';var initialValue=[{text:\"comprar lechuga\",completed:false},{text:\"comprar papa\",completed:true},{text:\"comprar tomate\",completed:false}];function useLocalStorage(){var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),error=_React$useState2[0],setError=_React$useState2[1];var _React$useState3=React.useState(true),_React$useState4=_slicedToArray(_React$useState3,2),loading=_React$useState4[0],setLoading=_React$useState4[1];var _React$useState5=React.useState(initialValue),_React$useState6=_slicedToArray(_React$useState5,2),item=_React$useState6[0],setItem=_React$useState6[1];var _React$useState7=React.useState(true),_React$useState8=_slicedToArray(_React$useState7,2),sincronized=_React$useState8[0],setSincronized=_React$useState8[1];React.useEffect(function(){setTimeout(function(){try{var localStorageItem=localStorage.getItem(localStorageKey);var parsedItem;if(!localStorageItem){localStorage.setItem(localStorageKey,JSON.stringify(initialValue));parsedItem=initialValue;}else{parsedItem=JSON.parse(localStorageItem);}setItem(parsedItem);setLoading(false);setSincronized(true);}catch(error){console.log('failed to load data with error: '+error);setError(true);}},1000);},[sincronized]);var saveItem=function saveItem(items){localStorage.setItem(localStorageKey,JSON.stringify(items));setItem(items);};var synchronize=function synchronize(){setLoading(true);setSincronized(false);};return{error:error,loading:loading,item:item,saveItem:saveItem,synchronize:synchronize};}export{useLocalStorage,localStorageKey};","map":{"version":3,"names":["React","localStorageKey","initialValue","text","completed","useLocalStorage","useState","error","setError","loading","setLoading","item","setItem","sincronized","setSincronized","useEffect","setTimeout","localStorageItem","localStorage","getItem","parsedItem","JSON","stringify","parse","console","log","saveItem","items","synchronize"],"sources":["/home/christian/Code/todo-made-in-react/src/Storage/useLocalStorage.tsx"],"sourcesContent":["import React from \"react\";\nimport {Todo} from \"../Todo/Todo\";\n\nconst localStorageKey = 'MY_TODOS_V1';\n\nconst initialValue : Todo[] = [\n  {text:\"comprar lechuga\", completed: false},\n  {text:\"comprar papa\", completed: true},\n  {text:\"comprar tomate\", completed: false}];\n\nfunction useLocalStorage() {\n  const [error, setError] = React.useState(false);\n  const [loading, setLoading] = React.useState(true);\n  const [item, setItem] = React.useState(initialValue);\n  const [sincronized, setSincronized] = React.useState(true);\n\n  React.useEffect(() => {\n    setTimeout(() => {\n      try {\n        const localStorageItem = localStorage.getItem(localStorageKey);\n        let parsedItem :Todo[];\n\n        if (!localStorageItem) {\n          localStorage.setItem(localStorageKey, JSON.stringify(initialValue));\n          parsedItem = initialValue;\n        } else {\n          parsedItem = JSON.parse(localStorageItem as string) as Array<Todo>;\n        }\n\n        setItem(parsedItem);\n        setLoading(false);\n        setSincronized(true);\n      } catch(error) {\n        console.log('failed to load data with error: ' + error);\n        setError(true);\n      }\n    }, 1000);\n  }, [sincronized]);\n\n  const saveItem = (items : Todo[]) => {\n    localStorage.setItem(localStorageKey, JSON.stringify(items));\n    setItem(items);\n  }\n\n  const synchronize = () => {\n    setLoading(true);\n    setSincronized(false);\n  }\n\n  return {\n    error,\n    loading,\n    item,\n    saveItem,\n    synchronize,\n  };\n}\n\nexport {useLocalStorage, localStorageKey}"],"mappings":"6HAAA,MAAOA,MAAP,KAAkB,OAAlB,CAGA,GAAMC,gBAAe,CAAG,aAAxB,CAEA,GAAMC,aAAqB,CAAG,CAC5B,CAACC,IAAI,CAAC,iBAAN,CAAyBC,SAAS,CAAE,KAApC,CAD4B,CAE5B,CAACD,IAAI,CAAC,cAAN,CAAsBC,SAAS,CAAE,IAAjC,CAF4B,CAG5B,CAACD,IAAI,CAAC,gBAAN,CAAwBC,SAAS,CAAE,KAAnC,CAH4B,CAA9B,CAKA,QAASC,gBAAT,EAA2B,CACzB,oBAA0BL,KAAK,CAACM,QAAN,CAAe,KAAf,CAA1B,oDAAOC,KAAP,qBAAcC,QAAd,qBACA,qBAA8BR,KAAK,CAACM,QAAN,CAAe,IAAf,CAA9B,qDAAOG,OAAP,qBAAgBC,UAAhB,qBACA,qBAAwBV,KAAK,CAACM,QAAN,CAAeJ,YAAf,CAAxB,qDAAOS,IAAP,qBAAaC,OAAb,qBACA,qBAAsCZ,KAAK,CAACM,QAAN,CAAe,IAAf,CAAtC,qDAAOO,WAAP,qBAAoBC,cAApB,qBAEAd,KAAK,CAACe,SAAN,CAAgB,UAAM,CACpBC,UAAU,CAAC,UAAM,CACf,GAAI,CACF,GAAMC,iBAAgB,CAAGC,YAAY,CAACC,OAAb,CAAqBlB,eAArB,CAAzB,CACA,GAAImB,WAAJ,CAEA,GAAI,CAACH,gBAAL,CAAuB,CACrBC,YAAY,CAACN,OAAb,CAAqBX,eAArB,CAAsCoB,IAAI,CAACC,SAAL,CAAepB,YAAf,CAAtC,EACAkB,UAAU,CAAGlB,YAAb,CACD,CAHD,IAGO,CACLkB,UAAU,CAAGC,IAAI,CAACE,KAAL,CAAWN,gBAAX,CAAb,CACD,CAEDL,OAAO,CAACQ,UAAD,CAAP,CACAV,UAAU,CAAC,KAAD,CAAV,CACAI,cAAc,CAAC,IAAD,CAAd,CACD,CAAC,MAAMP,KAAN,CAAa,CACbiB,OAAO,CAACC,GAAR,CAAY,mCAAqClB,KAAjD,EACAC,QAAQ,CAAC,IAAD,CAAR,CACD,CACF,CAnBS,CAmBP,IAnBO,CAAV,CAoBD,CArBD,CAqBG,CAACK,WAAD,CArBH,EAuBA,GAAMa,SAAQ,CAAG,QAAXA,SAAW,CAACC,KAAD,CAAoB,CACnCT,YAAY,CAACN,OAAb,CAAqBX,eAArB,CAAsCoB,IAAI,CAACC,SAAL,CAAeK,KAAf,CAAtC,EACAf,OAAO,CAACe,KAAD,CAAP,CACD,CAHD,CAKA,GAAMC,YAAW,CAAG,QAAdA,YAAc,EAAM,CACxBlB,UAAU,CAAC,IAAD,CAAV,CACAI,cAAc,CAAC,KAAD,CAAd,CACD,CAHD,CAKA,MAAO,CACLP,KAAK,CAALA,KADK,CAELE,OAAO,CAAPA,OAFK,CAGLE,IAAI,CAAJA,IAHK,CAILe,QAAQ,CAARA,QAJK,CAKLE,WAAW,CAAXA,WALK,CAAP,CAOD,CAED,OAAQvB,eAAR,CAAyBJ,eAAzB"},"metadata":{},"sourceType":"module"}